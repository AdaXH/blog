var _leftStyle,_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t(e):"function"==typeof define&&define.amd?define(t):t(e)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0,function(t){"use strict";var n,i=t.Base64;if("undefined"!=typeof module&&module.exports)if("undefined"!=typeof navigator&&"ReactNative"==navigator.product);else try{n=require("buffer").Buffer}catch(e){}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=function(e){for(var t={},n=0,i=e.length;n<i;n++)t[e.charAt(n)]=n;return t}(o),r=String.fromCharCode,s=function(e){if(e.length<2)return(t=e.charCodeAt(0))<128?e:t<2048?r(192|t>>>6)+r(128|63&t):r(224|t>>>12&15)+r(128|t>>>6&63)+r(128|63&t);var t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return r(240|t>>>18&7)+r(128|t>>>12&63)+r(128|t>>>6&63)+r(128|63&t)},l=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(e){return e.replace(l,s)},u=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(1<e.length?e.charCodeAt(1):0)<<8|(2<e.length?e.charCodeAt(2):0);return[o.charAt(n>>>18),o.charAt(n>>>12&63),2<=t?"=":o.charAt(n>>>6&63),1<=t?"=":o.charAt(63&n)].join("")},d=t.btoa?function(e){return t.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,u)},f=n?n.from&&Uint8Array&&n.from!==Uint8Array.from?function(e){return(e.constructor===n.constructor?e:n.from(e)).toString("base64")}:function(e){return(e.constructor===n.constructor?e:new n(e)).toString("base64")}:function(e){return d(c(e))},h=function(e,t){return t?f(String(e)).replace(/[+\/]/g,function(e){return"+"==e?"-":"_"}).replace(/=/g,""):f(String(e))},g=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),p=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return r(55296+(t>>>10))+r(56320+(1023&t));case 3:return r((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return r((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},m=function(e){return e.replace(g,p)},y=function(e){var t=e.length,n=t%4,i=(0<t?a[e.charAt(0)]<<18:0)|(1<t?a[e.charAt(1)]<<12:0)|(2<t?a[e.charAt(2)]<<6:0)|(3<t?a[e.charAt(3)]:0),o=[r(i>>>16),r(i>>>8&255),r(255&i)];return o.length-=[0,0,2,1][n],o.join("")},v=t.atob?function(e){return t.atob(e)}:function(e){return e.replace(/[\s\S]{1,4}/g,y)},_=n?n.from&&Uint8Array&&n.from!==Uint8Array.from?function(e){return(e.constructor===n.constructor?e:n.from(e,"base64")).toString()}:function(e){return(e.constructor===n.constructor?e:new n(e,"base64")).toString()}:function(e){return m(v(e))},e=function(e){return _(String(e).replace(/[-_]/g,function(e){return"-"==e?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};if(t.Base64={VERSION:"2.4.8",atob:v,btoa:d,fromBase64:e,toBase64:h,utob:c,encode:h,encodeURI:function(e){return h(e,!0)},btou:m,decode:e,noConflict:function(){var e=t.Base64;return t.Base64=i,e}},"function"==typeof Object.defineProperty){var $=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",$(function(){return e(this)})),Object.defineProperty(String.prototype,"toBase64",$(function(e){return h(this,e)})),Object.defineProperty(String.prototype,"toBase64URI",$(function(){return h(this,!0)}))}}return t.Meteor&&(Base64=t.Base64),"undefined"!=typeof module&&module.exports?module.exports.Base64=t.Base64:"function"==typeof define&&define.amd&&define([],function(){return t.Base64}),{Base64:t.Base64}});var Mobile=function(){function t(e){_classCallCheck(this,t),this.items=e&&e.menu&&0!==e.menu.length?e.menu:[{name:"menu1",callback:function(){return console.log("click menu1")}},{name:"menu2",callback:function(){return console.log("click menu2")}}],this.appendTarget=e&&e.target||document.body,this.bg=e&&e.bg||"http://www.rui2.net/uploadfile/output/3/2013/1001/4acf64758d420524.jpg",this.ul={},this.interval=void 0,this.menuColor=e&&e.menuColor||"black",this.searchInterval=void 0,this.searchCallback=e&&e.searchCallback||function(e){console.log(e)},this.appendNodes=[]}return _createClass(t,[{key:"start",value:function(){var e=this;document.getElementById("_container")&&0!==document.getElementById("_container").childNodes.length||(this.init(),setTimeout(function(){e.container.style.transform="rotateX(45deg) rotateY(68deg) rotateZ(-45deg) scale(1.3)",setTimeout(function(){e.container.style.transform="rotateX(60deg) rotateZ(45deg) rotateY(0deg) scale(1.3)"},1e3)},1e3))}},{key:"end",value:function(){this.interval&&clearInterval(this.interval),this.searchInterval&&clearInterval(this.searchInterval),document.getElementById("_container")&&this.appendTarget.removeChild(document.getElementById("_container"))}},{key:"init",value:function(){this.createOperationUl(),this.addMouseEnter(this.ul),this.appendNodes=[this.createTopface,this.createBackface,this.createRight,this.createLeft,this.createBottom,this.createForward,this.createOperation],this.createContainer(this.appendNodes),this.renderTime()}},{key:"addMouseEnter",value:function(e){for(var t=e.ul,n=e.ul2,i=e.ul3,o=this,a=t.getElementsByTagName("li"),r=n.getElementsByTagName("li"),s=i.getElementsByTagName("li"),l=function(e){a[e].onmouseover=function(){recover(a,{background:"none",paddingLeft:"10px",color:o.menuColor}),recover(r,{background:"none"}),recover(s,{background:"none"}),this.style.background="#A4D768",this.style.paddingLeft="20px",this.style.color="white",r[e].style.background="#A4D768",s[e].style.background="#A4D768"}},c=0;c<a.length;c++)l(c);t.onmouseleave=function(){recover(a,{background:"none",paddingLeft:"10px",color:o.menuColor}),recover(r,{background:"none"}),recover(s,{background:"none"})}}},{key:"createClock",value:function(){var e=document.createElement("div");setStyle(e,clockStyle);var t=document.createElement("p");return t.setAttribute("id","menu_plugin_clock"),setStyle(t,timeStyle),e.appendChild(t),e}},{key:"renderTime",value:function(){var o=document.getElementById("menu_plugin_clock"),e=document.getElementById("_search");this.searchInterval=setInterval(function(){e.style.opacity="0.2",setTimeout(function(){e.style.opacity="1"},1500)},3e3),this.interval=setInterval(function(){var e=new Date,t=e.getHours()<10?"0"+e.getHours():e.getHours(),n=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),i=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();o.innerText=t+" : "+n+" : "+i},1e3)}},{key:"createSearch",value:function(){var t=this,e=document.createElement("div");e.setAttribute("id","_search");var n=document.createElement("input");return setStyle(n,inputStyle),setStyle(e,searchStyle),n.placeholder="O",n.addEventListener("focus",function(){this.style.width="140px",clearInterval(t.searchInterval),this.style.paddingLeft="20px",this.style.textAlign="left",this.placeholder=""},!1),n.addEventListener("blur",function(){this.style.width="25px",this.style.paddingLeft="0px",this.style.textAlign="center",this.placeholder="O",t.searchInterval=setInterval(function(){e.style.opacity="0.2",setTimeout(function(){e.style.opacity="1"},1500)},3e3)},!1),n.addEventListener("keydown",function(e){13===(e||window.event).keyCode&&t.searchCallback(this.value)},!1),e.appendChild(n),e}},{key:"createContainer",value:function(e){var t=document.createElement("div");setStyle(t,containerStyle),t.setAttribute("id","_container");var n=!0,i=!1,o=void 0;try{for(var a,r=e[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;if(/Object/.test(Object.prototype.toString.call(s.call(this)))){var l=s.call(this);for(var c in l)t.appendChild(l[c])}else t.appendChild(s.call(this))}}catch(e){i=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}this.container=t,this.appendTarget.style.perspective="1400px",this.appendTarget.style.transformStyle="preserve-3d",this.appendTarget.appendChild(t)}},{key:"createOperation",value:function(){var e=this,t=document.createElement("p");t.innerText=" <",setStyle(t,leftOstyle),t.addEventListener("click",function(){e.container.style.transform="rotateX(60deg) rotateZ(45deg) rotateY(0deg) scale(1.3)"},!1);var n=document.createElement("p");n.innerText=" >",setStyle(n,rightOstyle),n.addEventListener("click",function(){e.container.style.transform="rotateX(45deg) rotateZ(-45deg) rotateY(0deg) scale(1.3)"},!1);var i=document.createElement("p");return i.innerText="x",i.addEventListener("click",function(){e.container.style.transform="rotateX(0deg) rotateZ(0deg) rotateY(0deg) scale(1)"},!1),setStyle(i,closeOStyle),{leftO:t,rightO:n,closeO:i}}},{key:"createTopface",value:function(){var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div");i.innerText=".....",n.innerText="100%",setStyle(o,statusBarStyle),setStyle(t,barreryStyle),setStyle(n,barreryStatusStyle),setStyle(e,topStyle),setStyle(i,singStyle),e.appendChild(this.ul.ul);this.ul.ul.getElementsByTagName("li");return e.style.background="url("+this.bg+")",e.style.backgroundSize="cover",o.appendChild(n),o.appendChild(t),o.appendChild(i),e.appendChild(o),e.appendChild(this.createClock()),e.appendChild(this.createSearch()),e}},{key:"createBackface",value:function(){var e=document.createElement("div");return setStyle(e,backStyle),e.style.background="url("+this.bg+")",e.style.backgroundSize="cover",e}},{key:"createLeft",value:function(){var e=document.createElement("div");return setStyle(e,leftStyle),e.style.background="url("+this.bg+") left",e.style.backgroundSize="cover",e.appendChild(this.ul.ul3),e}},{key:"createRight",value:function(){var e=document.createElement("div");return setStyle(e,rightStyle),e.style.background="url("+this.bg+") right",e.style.backgroundSize="cover",e.appendChild(this.ul.ul2),e}},{key:"createBottom",value:function(){var e=document.createElement("div");return setStyle(e,bottomStyle),e.style.background="url("+this.bg+") bottom",e.style.backgroundSize="cover",e}},{key:"createForward",value:function(){var e=document.createElement("div");return setStyle(e,forwardStyle),e.style.background="url("+this.bg+") top",e.style.backgroundSize="cover",e}},{key:"createOperationUl",value:function(){var e=document.createElement("ul"),t=document.createElement("ul"),n=document.createElement("ul"),i=!0,o=!1,a=void 0;try{for(var r,s=this.items[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value,c=document.createElement("li"),u=document.createElement("li"),d=document.createElement("li");c.innerText=l.name,l.callback&&c.addEventListener("click",l.callback,!1),e.appendChild(setStyle(c,li1Style)),c.style.color=this.menuColor,u.style.height="30px",u.style.transition="all ease .3s",u.style.boxSizing="border-box",d.style.height="30px",d.style.transition="all ease .3s",d.style.boxSizing="border-box",t.appendChild(u),n.appendChild(d)}}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}setStyle(e,ul1Style),setStyle(t,ul2Style),setStyle(n,ul2Style),this.ul={ul:e,ul2:t,ul3:n}}}]),t}();function recover(e,t){var n=!0,i=!1,o=void 0;try{for(var a,r=e[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;for(var l in t)s.style[l]=t[l]}}catch(e){i=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}}function setStyle(e,t){if(!e||!t)return null;if(!t)return e;for(var n in t)e.style[n]=t[n];return e}var leftOstyle={position:"absolute",left:"300px",bottom:"50px",cursor:"pointer",fontSize:"20px","text-shadow":"0px 10px 10px rgba(6, 5, 5, 0.9)"},statusBarStyle={position:"absolute",width:"100%",height:"20px",top:"6x"},barreryStyle={position:"absolute",top:"6px",right:"6px",width:"20px",height:"8px",background:"white",borderRadius:"3px"},singStyle={position:"absolute",top:"-2px",left:"6px",color:"white",fontSize:"25px",lineHeight:"8px"},barreryStatusStyle={position:"absolute",width:"20px",top:"6px",right:"35px",lineHeight:"8px",textAligin:"center",color:"white",fontSize:"12px",transform:"scale(0.7)"},closeOStyle={position:"absolute",bottom:"50px",cursor:"pointer",fontSize:"20px","text-shadow":"0px 10px 10px rgba(6, 5, 5, 0.9)",left:"400px"},rightOstyle={position:"absolute",right:"200px",bottom:"50px",cursor:"pointer",fontSize:"20px","text-shadow":"0px 10px 10px rgba(6, 5, 5, 0.9)"},clockStyle={position:" absolute",width:"200px",height:"100px",top:"20px"},inputStyle={outline:"none",border:"none",display:"block",margin:"0px auto",cursor:"pointer",textAlign:"center",width:"25px",transition:"all .3s",height:"25px",background:"rgba(255,255,255,0.7)",borderRadius:"12.5px",color:"#666",fontSize:"12px"},searchStyle={willChange:"opacity",width:"200px",height:"30px",position:"absolute",top:"130px",opacity:"0.2",filter:"alpha(opacity = 20)",transition:"all 1s","transform-style":"preserve-3d",transform:"translateZ(1px)"},timeStyle={textAlign:"center",lineHeight:"100px",fontSize:"20px",color:"white"},ul2Style={width:"20px",position:"absolute",bottom:"20px",minHeight:"70px"},ul1Style={position:"absolute",bottom:"20px",left:"0",cursor:"pointer",minHeight:"70px","transform-style":"preserve-3d",transform:"translateZ(0.1px)"},li1Style={transformStyle:"preserve-3d",transform:"translateX(-1px)",padding:"0 0 0 10px",height:"30px","line-height":"30px",width:"200px",fontSize:"12px",transition:"all ease .3s","box-sizing":"border-box",cursor:"pointer"},bottomStyle={"transform-style":"preserve-3d",transform:"rotateX(90deg) rotateY(0deg) rotateZ(0deg) translateY(-10px) translateZ(-10px)",position:"absolute","box-sizing":"border-box",width:"200px",top:"430px",left:"300px",height:"20px","transform-origin":"left","background-size":"auto",borderRadius:"10px"},forwardStyle={"transform-style":"preserve-3d",transform:"rotateX(90deg) rotateY(0deg) rotateZ(0deg) translateY(-10px) translateZ(-10px)",position:"absolute","box-sizing":"border-box",width:"200px",top:"30px",left:"300px",height:"20px","transform-origin":"left","background-size":"auto",borderRadius:"10px"},rightStyle={"transform-style":"preserve-3d",position:"absolute","box-sizing":"border-box",width:"20px",height:"400px",left:"480px",top:"50px","background-size":"cover",transform:"rotateY(90deg) translateZ(10px)  translateX(10px)",borderRadius:"10px"},leftStyle=(_defineProperty(_leftStyle={"transform-style":"preserve-3d",position:"absolute","box-sizing":"border-box",width:"20px"},"transform-style","preserve-3d"),_defineProperty(_leftStyle,"height","400px"),_defineProperty(_leftStyle,"left","280px"),_defineProperty(_leftStyle,"top","50px"),_defineProperty(_leftStyle,"background-size","cover"),_defineProperty(_leftStyle,"transform","rotateY(-90deg) translateX(-10px) translateY(0px) translateZ(-10px)"),_defineProperty(_leftStyle,"borderRadius","10px"),_leftStyle),topStyle={width:"200px",height:"400px",left:"300px",top:"50px",zIndex:"1","transform-origin":"top","background-size":"cover",border:"0.5px solid white",position:"absolute",borderRadius:"5px","box-sizing":"border-box",transformStyle:"preserve-3d",transform:"translateZ(0px)"},backStyle={width:"200px",height:"400px",left:"300px",top:"50px","transform-origin":"top","background-size":"cover",position:"absolute",borderRadius:"10px","box-sizing":"border-box","box-shadow":"0px 50px 50px rgba(6, 5, 5, 0.9)",transformStyle:"preserve-3d",transform:"translateZ(-20px)"},shadowStyle={"transform-style":"preserve-3d",width:"200px",height:"400px",left:"300px",top:"50px","transform-origin":"top",position:"absolute","box-sizing":"border-box",background:"transparent",transform:"translateZ(-100px)"},containerStyle={"will-change":"transform",width:"700px",height:"600px",position:"absolute",top:"50%",zIndex:"5",left:"41%",margin:"-300px 0 0 -350px",perspective:"1400px","transform-style":"preserve-3d","transform-origin":"center",transition:"all 1s"},src=["./../upload/user_avatar/lyy.jpg","./../resouce/images/qq.png","./../resouce/images/load.png","./../resouce/images/qzone.png","./../resouce/images/wechat.png","./../resouce/images/ly.jpg","./../resouce/bg/1.jpg","./../resouce/bg/2.jpg","./../resouce/bg/3.jpg","./../resouce/bg/4.jpg","./../resouce/bg/5.jpg","./../resouce/bg/6.jpg","./../upload/user_avatar/default_avatar.jpg","./../resouce/gallery/1.jpg","./../resouce/gallery/2.jpg","./../resouce/gallery/3.jpg","./../resouce/gallery/4.jpg","./../resouce/gallery/5.jpg","./../resouce/gallery/6.jpg","./../resouce/gallery/7.jpg","./../resouce/gallery/8.jpg","./../resouce/gallery/9.jpg","./../resouce/gallery/10.jpg","./../resouce/gallery/11.jpg","./../resouce/gallery/12.jpg","./../resouce/images/loading.png","./../resouce/images/loading1.png","./../resouce/images/point.png","./../resouce/images/time.png","./../resouce/images/title.png","./../resouce/images/type.png","./../resouce/images/menu.jpg"],len=0,l=src.length,_iteratorNormalCompletion4=!0,_didIteratorError4=!1,_iteratorError4=void 0;try{for(var _step4,_iterator4=src[Symbol.iterator]();!(_iteratorNormalCompletion4=(_step4=_iterator4.next()).done);_iteratorNormalCompletion4=!0){var item=_step4.value,img=new Image;img.src=item,img.onload=function(){check(++len)},img.onerror=function(){check(++len)}}}catch(e){_didIteratorError4=!0,_iteratorError4=e}finally{try{!_iteratorNormalCompletion4&&_iterator4.return&&_iterator4.return()}finally{if(_didIteratorError4)throw _iteratorError4}}function check(e){$("#percentText").text((100*parseFloat(e/l)).toFixed(0)),e===l&&setTimeout(function(){return $("#srcLoading").remove()},800)}var HashRoute=function(){function t(e){_classCallCheck(this,t),this.map=e,this.routes={},this.curUrl=""}return _createClass(t,[{key:"reload",value:function(){this.curUrl=location.hash.substring(0)||"#/index",this.routes[this.curUrl]()}},{key:"init",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,o=this.map[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this.routes[a.url]=a.map}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}window.addEventListener("hashchange",this.reload.bind(this))}}]),t}();function hashRouter(){var s=$("header .nav li");function e(e){var t=!0,n=!1,i=void 0;try{for(var o,a=s[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;if($(r).find("a")[0].getAttribute("href")===e)return void $(r).find("a").trigger("click")}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}new HashRoute([{url:"#/index",map:function(){return e("#/index")}},{url:"#/article",map:function(){return e("#/article")}},{url:"#/message",map:function(){return e("#/message")}},{url:"#/about",map:function(){return e("#/about")}}]).init()}function closeAddArticle(e,t){$(".close_add_article").on("click  ",function(){$(".error_information").hide(),$(".add_article_overlay").animate({opacity:0},750).find(".add_article_box").css("transform","scale(.7)"),setTimeout(function(){$(".add_article_overlay").css("z-index","-1")},1e3)})}function exitLoginRegCancel(){$(".exit").on("click  ",function(){exitLoginRegFace()})}function loginFn(e){$(".new_login").on("click.exitLogin  ",function(){$("#login").show(),$(".login_register").find("#register").hide().prev().show(),$(".login_register").find("#check_password").hide(),showLoginRegFace(),new RegisterClass(e).signUp()})}function showLoginRegFace(){$(".login_register").show().css("z-index","999").find(".bar").animate({height:$(".login_register").height()/2},1e3,function(){$(".login-effect").css("opacity","1").css("transform","scale(1)")})}function register(){$(".new_register").on("click  ",function(){$(".login_register").find("#login").hide(),$("#register").show().prev().hide(),$("#check_password").show(),showLoginRegFace();var e=new RegisterClass;e.reg(),e.signUp()})}!function(w){w.fn.extend({glitch:function(e){var t,n,$=this,b={zIndexDefault:3,effect1TimeMin:600,effect1TimeMax:900,effect2TimeMin:10,effect2TimeMax:115,time:100};function x(e,t){return Math.floor(Math.random()*(t-e+1))+e}b=w.extend(b,e),n=b,(t=this).clone().insertBefore(t).css({"z-index":n.zIndexDefault}),w(t).clone().insertAfter(t).addClass("front-3").css({"z-index":n.zIndexDefault+1}),t.clone().insertAfter(t).css({"z-index":n.zIndexDefault+2}),setInterval(function(){var e,t,n,i,o,a,r,s,l,c,u,d,f,h,g,p,m,y,v,_;e=$,t=b,n=x(10,1900),i=x(10,1300),o=x(0,16),a=x(0,16),x(t.effect1TimeMin,t.effect1TimeMax),w(e).css({clip:"rect("+n+"px, 9999px, "+i+"px,0px)",right:a,left:o}),r=$,s=b,l=x(10,1900),c=x(10,1300),u=x(0,40),d=x(0,40),x(s.effect2TimeMin,s.effect2TimeMax),f=(Math.random()*(1.1-.9)+.9).toFixed(2),w(r).next().css({clip:"rect("+l+"px, 9999px, "+c+"px,0px)",left:u,right:d,"-webkit-transform":"scale("+f+")","-ms-transform":"scale("+f+")",transform:"scale("+f+")"}),h=$,g=b,p=x(10,1900),m=x(10,1300),y=x(0,40),v=x(0,40),_=(Math.random()*(1.1-.9)+.9).toFixed(2),x(g.effect2TimeMin,g.effect2TimeMax),w(h).next().next().css({clip:"rect("+p+"px, 9999px, "+m+"px,0px)",left:y,right:v,"-webkit-transform":"scale("+_+")","-ms-transform":"scale("+_+")",transform:"scale("+_+")","mix-blend-mode":"hue"})},b.time)}})}(jQuery),jQuery.fn.extend({shake:function(e,t,n){var i=this;"static"===this.css("position")&&this.css("position","relative");var o,a={x:parseInt(this.css("left")),y:parseInt(this.css("top")),fsz:parseInt(this.css("font-size"))};return i.animate({fontSize:a.fsz+5,left:a.x-t},e/2).animate({left:a.x+t},e/2),o=2*t,i.id=setInterval(function(){i.animate({left:a.x-o},e/2).animate({left:a.x+o},e/2),0==(o-=2)&&(o=t,clearInterval(i.id))},e),i.closest("li").mouseout(function(){clearInterval(i.id),i.stop().animate({fontSize:a.fsz,left:a.x,top:a.y},50)}),this}});var RegisterClass=function(){function t(e){_classCallCheck(this,t),void 0===e&&(e="Ada"),this.name=e}return _createClass(t,[{key:"reg",value:function(){$("#login").hide(),$("#register").on("click  ",function(){var e=$("#username").val(),t=$("#check_password").val(),n=$("#password").val();/\s/.test(e)?infoContainer("用户名不能包含空格",!1):/\s/.test(n)?infoContainer("密码不能包含空格",!1):30<e.length?infoContainer("用户名字符长度不能超过30",!1):e!==self.name&&""!==e?""!==n?n&&n.length<6||n&&15<n.length?infoContainer("密码长度:6-15位",!1):n===t?fetch("/register",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({name:e,pwd:Base64.encode(t)})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){e&&e.success?infoContainer("注册成功，请登录",!0,function(){return setLogin()}):infoContainer(e&&e.errorMsg||"网络出错"+e.status)}):infoContainer("两次密码不一致",!1):infoContainer("请输入密码",!1):infoContainer("请输入用户名",!1)})}},{key:"signUp",value:function(){$(".register span").css("color","#6fb2df").html(" "),$("#login").on("click  ",function(){var t=$("#username").val(),e=$(".register input[type=checkbox]")[0].checked;""!==$("#username").val()?""!==$("#password").val()?fetch("/login",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},credentials:"include",body:JSON.stringify({name:t,pwd:Base64.encode($("#password").val()),state:e})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){e&&e.success?(window.sessionStorage&&sessionStorage.getItem("user")&&sessionStorage.removeItem("user"),sessionStorage&&sessionStorage.setItem("user",Base64.encode(t)),$(".register span").css("color","#6fb2df").html(t),$(".user_name").html(t),$("#login_anchor").html("register"),exitLoginRegFace(),repeatCon(t),uploadAvatar(Base64.decode(sessionStorage.getItem("user"))),getAvatar(Base64.decode(sessionStorage.getItem("user"))),$("#avatar").show(),$(".avatarTip").show(),$("#setAvatarTip").show(),e.avatar&&($(".avatar_img")[0].src=e.avatar),messageOperation(t),e.admin&&(adminToggle(),publishDynamic(),publishItem(),deleteDynamic(),deleteArticle(),adminEdit(),updateArticle(),editDynamic(),adminUI()),$(".new_login span").text("注销"),loginOut()):infoContainer(e&&e.errorMsg||"网络错误"+e.status)}):infoContainer("请输入密码",!1):infoContainer("请输入用户名",!1)})}}]),t}();function exitLoginRegFace(){$(".login-effect").css("transform","scale(.7)").css("opacity","0"),setTimeout(function(){$(".login_register").find(".bar").animate({height:0},750,function(){$(".login_register").css("z-index","0").hide()})},650)}function setLogin(){$(".register label").show(),$(".label-con").show(),$("#login").show(),$("#check_password").hide(),$(".login-effect").animate({height:267}),$("#register").hide().next().show()}var MessageModel=function(){function t(e){_classCallCheck(this,t),this.name=e}return _createClass(t,[{key:"saveMsg",value:function(){var o=this;$(".message_board_input input[type=button]").on("click  ",function(){var e=$(".message_board_input input[type=text]").val(),t=new Date,n=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),i=$(".message_board_input textarea").val();""!==e&&""!==i&&$.post("./addMessage",{username:o.name,name:e,content:i,date:n},function(e){e&&getMessage(o.name)})})}}]),t}();function getMessage(e){var i=[];$.post("./messages",{username:e},function(e){for(var t=e.length-1;0<=t;t--)i.push(e[t]);var n=template("message_tpl",{messages:i});$(".message_list li").remove(),$(".message_list").append($(n)),messageCount(i.length)})}function messageCount(e){$(".temp_ul li").eq(0).html(e+"评论").next().html(e+"人参与")}function articleData(e){$(".article_list li").remove(),$(".all_article li").remove();var i=[];void 0===e&&(e="admin"),$.post("./articles",{username:e},function(e){for(var t=e.length-1;0<=t;t--)i.push(e[t]);var n=template("article_tpl",{articles:i});$(n).appendTo($(".article_list")),showArticle(),setTimeout(function(){allArticle()},0)})}function showArticle(){$(".article_list .article"),$(".face").width(),$(".face").height();var t={left:.25*$(".article_list .article").width(),width:$(".article_list .article").width(),height:$(".article_list .article").height(),spanWd:$(".article_list .article .article_date").width()};$(".article_list").on("click  ",".article",function(e){(e=e||window.event).stopPropagation(),$(".context-menu").hide(),updateViewer(this.getAttribute("_id"),Number($(this).find(".article-viewer span:nth-of-type(2)").text()),$(this).find(".article-viewer span:nth-of-type(2)"),this),$(this).addClass("showArticle").siblings().removeClass("showArticle").find(".article_tittle").removeClass("article_title_toggle"),$(this).siblings().find(".article_summary").removeClass("toggleP"),$(this).find(".article_close").addClass("showClose"),$(this).siblings().find(".article_close").removeClass("showClose"),$(this).find(".article_tittle").addClass("article_title_toggle"),$(this).find(".article_summary").addClass("toggleP"),showArticlePrepare($(this)),closeArticle($(this),t)})}function updateViewer(e,t,n,i){i.isClick||fetch("/updateArticleViewerById",{method:"POST",headers:{"content-type":"application/json",accept:"application"},body:JSON.stringify({_id:e,viewer:t})}).then(function(e){if(e.json)return e.json()}).then(function(e){e&&e.success&&(n.text(String(t+1)),i.isClick=!0)})}function showArticlePrepare(e){$(".right_article_list").hide(500),e.find(".article_close").show(500)}function closeArticleNew(){$(".article_list").on("click  ",".article_close",function(e){$(this).closest(".article").find(".article_tittle").removeClass("article_title_toggle"),$(this).closest(".article").removeClass("showArticle").find(".article_summary").removeClass("toggleP"),$(".right_article_list").show(500),(e=e||window.event).stopPropagation(),$(".context-menu").hide(),$(this).removeClass("showClose")})}function closeArticle(t,e){t.find(".article_close").on("click  ",function(e){t.find(".article_tittle").removeClass("article_title_toggle"),t.removeClass("showArticle").find(".article_summary").removeClass("toggleP"),$(".right_article_list").show(500),(e=e||window.event).stopPropagation(),$(".context-menu").hide(),$(this).removeClass("showClose")})}function face1LeftbaraShake(){$(".face:nth-of-type(1) .left_bar .user_down .user_menu li a").mouseenter(function(){$(this).shake(400,6,1.2)}),$(".sharetoqzone").mouseenter}function mottoSlide(e){var t=parseInt(e.css("top"));e.show().css({opacity:0,top:t-30}).animate({opacity:1,top:t},700)}function selectNav(){var e=$("header .nav li a"),a=$(".screen main .all .face"),r=(a.height(),a.width());e.on("click  ",function(){a.css("display","block"),$(".insert_dialog").hide();var e=$(this).parent().index();function t(e){e.css({opacity:1,transform:"translateX(0) translateZ(0)"})}function n(e){e.css({opacity:0,transform:"translateX(-40px) translateZ(0)"})}if(1===e)$(".right_article_list").show(500),t($(".article_summary"));else if(3===e){var i=this;if(!this.isIntroduce){var o=$("#introduce_textarea");fetch("/introduce",{method:"POST",headers:{accept:"application/json","content-type":"application/json"}}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){e&&e.success&&(introduce(0,e.introduce),o.val(e.introduce),i.isIntroduce=!0)}).catch(function(e){return infoContainer(e&&e.errorMsg||e)})}}else 1!==e&&($(".right_article_list").hide(),n($(".article_summary")));0===e?(sliderObj.autoSlide(),t($(".dynamic .title")),t($(".mood_item p"))):(sliderObj.stopSlide(),n($(".dynamic .title")),n($(".mood_item p"))),2===e?t($(".message_list p")):n($(".message_list p")),a.eq(e).siblings().css({transform:"translateX(-"+r+"px) translateZ(0)",opacity:0,zIndex:-1}),a.eq(e).css("z-index","3"),a.eq(e).css({opacity:1,transform:"translateX(0) translateZ(0)"})})}function init(){$(".motto").hide();$(".screen main")[0].offsetWidth;sliderObj=new SetSlide(1),sliderObj.slideInit(),sliderObj.slideStatus(),sliderObj.autoSlide(),$(".add_article_overlay").hide().css("opacity","0"),closeAddArticle(null,null);var e=$(".all .face").width();$("main").css({height:"90%"}),$(".all .face").css({transform:"translateX("+e+") translateZ(0)"}).eq(0).css({transform:"translateX(0) translateZ(0)"}),sessionStorage&&"Ada"!==Base64.decode(sessionStorage.getItem("user"))&&$(".delete_msg").css("cursor","not-allowed")}function SetSlide(e){this.id=null,this.current=e,this.wd=$(".slide_photo li").width();var n=this;this.slideInit=function(){var e=$(".slide_photo li").eq(0).clone(),t=$(".slide_photo li:last-of-type").clone();e.appendTo(".slide_photo"),t.prependTo(".slide_photo"),count=$(".slide_photo li").length,$(".slide_photo").css({width:count*n.wd}),$(".slide_photo").css("left","-"+n.wd+"px")},this.slideStatus=function(){$(".slide_photo_box .slide_photo").mouseenter(function(){n.stopSlide()}),$(".slide_photo_box .slide_photo").mouseleave(function(){n.autoSlide()})},this.autoSlide=function(){clearInterval(n.id),this.id=setInterval(function(){n.slideNext()},3e3)},this.stopSlide=function(){clearInterval(n.id)},this.slideNext=function(){this.current++,this.slideTo(this.current)},this.slideTo=function(e){-1===e&&($(".slide_photo").css({left:-this.wd*(count-2)}),e=this.current=count-3),e===count&&($(".slide_photo").css({left:-1*this.wd}),e=this.current=2);var t=-e*this.wd;$(".slide_photo").animate({left:t},1500)}}function loading(){for(var i=$(".loading .loading_top").height()/2,o=$(".loading_dot div"),a=[],e=o.length,t=0;t<e;t++)a.push(o[t].offsetTop);$(".loading_btn").mouseup(function(){return o.show(),$(".loading_btn").css({top:30}),window.onmousemove=null,!(window.onmouseup=function(){return o.show(),$(".loading_btn").css({top:30}),window.onmousemove=null,!1})}),$(".loading_btn").mousedown(function(e){e=e||window.event,$(".loading_center_box")[0].offsetTop;var n=e.clientY;window.onmousemove=function(e){var t=(e=e||window.event).clientY-n+25;return eatDot(a,t-25,o),$(".loading_btn").css({top:t}),checkLoadingFinished(i,t),!1}})}function checkLoadingFinished(e,t){280<=t&&(window.onmousemove=null,$(".loading_center_box").hide(),$(".loading_top").animate({height:100},300).animate({height:0},700),$(".loading_down").animate({height:100},300).animate({height:0},700),setTimeout(function(){$(".loading").hide()},1e3),$(".screen").show(2e3).find("main").show())}function eatDot(e,t,n){for(var i=e.length,o=0;o<i;o++)t>=e[o]?$(n[o]).hide():$(n[o]).show()}function asideTextHover(){$("aside .aside_menu li").mouseenter(function(){$(this).find("i.shake").stop().shake(400,3,1.2)})}function loginWarning(){$(".menu_toggle").on("click.loginMove  ",function(){$(".new_login").removeClass("tada"),setTimeout(function(){$(".new_login").addClass("tada")})})}function uploadAvatar(n){if(!(void 0===n||30<=n.length)){var e=document.getElementById("avatar"),r=document.getElementsByClassName("avatar_img");e.addEventListener("change",function(){var e=this.files[0],a=e.name;if(/image\/\w+/.test(e.type)){var t=new FileReader;t.readAsBinaryString(e),t.onload=function(){var e=this.result;fetch("/set-avatar",{method:"POST",body:JSON.stringify({avatar:e,name:n,fileName:a}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(e){return e.status<=200&&e.status<300?e.json():e}).then(function(e){e&&e.success?infoContainer("更新头像成功",!0,function(){var e=!0,t=!1,n=void 0;try{for(var i,o=r[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){i.value.src="/upload/user_avatar/"+a}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}):infoContainer(e&&e.errorMsg||"网络出错 "+e.status)})}}else infoContainer("请确保文件为图像类型",!1)},!1)}}function getAvatar(e){if(!(void 0===e||100<=e.length)){var r=document.getElementsByClassName("avatar_img");fetch("/get-avatar",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({name:Base64.encode(JSON.stringify({name:e}))})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){if(e&&e.success){var t=!0,n=!1,i=void 0;try{for(var o,a=r[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){o.value.src=e.data}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}else infoContainer(e&&e.errorMsg||"网络出错"+e.status,!1)})}}function repeatCon(o){$(".message_list").off("click").on("click","a.repeat_msg",function(){if(void 0===o||30<=o.length)infoContainer("你还没有登陆",!1);else{var n=this.getAttribute("_id"),i=this.getAttribute("_to_repeat");o?sendRepeat(function(e,t){fetch("/repeatMsg",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:n,msg:{info:t,name:o,date:e,toRepeat:i}})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){loadingUI("end"),e&&e.success?($(".repeat_word").val(""),reRenderMsg(e.data),$(".cancel_repeat").trigger("click")):infoContainer(e&&e.errorMsg||"网络繁忙"+e)})}):infoContainer("你还没有登陆",!1,function(){$("a.new_login").trigger("click")})}})}function escapeMessage(e){return e?e.replace(/<\/?script>+|傻逼+|爸爸+|你爸+|SB+|sB+|sb+|操+|你妈/g,"**"):""}function sendRepeat(r){$(".repeat_over").addClass("bounceIn").show(),$(".cancel_repeat").click(function(e){$(".repeat_over").hide().removeClass("bounceIn")}),$(".submit_repeat").off("click").on("click",function(){var e=escapeMessage($(".repeat_word").val().replace(/<\/?script>/g,"")),t=new Date,n=t.getMinutes(),i=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds(),o=t.getHours()<10?"0"+t.getHours():t.getHours(),a=t.getFullYear()+"/"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/"+(t.getDate()<10?"0"+t.getDate():t.getDate())+" "+o+":"+n+":"+i;""!==e&&""!==e.trim()?280<e.length?infoContainer("内容不能超过280字",!1):(loadingUI("start"),r&&r(a,e)):infoContainer("回复内容不能为空",!1)})}function messageOperation(e){(e=e||sessionStorage&&sessionStorage.getItem("user")||void 0)&&isAdmin(e,function(){$(".message_list").on("click","a.delete_msg",function(){var e=this.getAttribute("_id"),t=this;loadingUI("start"),fetch("/deleteMsgById",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:e})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){loadingUI("end"),e&&e.success?(infoContainer("删除成功",!0),$(t).closest("li").remove()):infoContainer(e&&e.errorMsg||"网络繁忙"+e)})})}).catch(function(e){})}function isAdmin(e,i){if(e&&""!==e)return new Promise(function(t,n){fetch("/checkAdmin",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({name:Base64.encode(JSON.stringify({name:e}))})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){e&&e.success?(t(e.data),i&&i()):n(e&&e.errorMsg||"获取权限失败"+e)})})}function checkPerssion(e){e&&null!=Base64.decode(e)?isAdmin(e).then(function(e){e&&(adminToggle(),publishDynamic(),publishItem(),deleteDynamic(),deleteArticle(),adminEdit(),updateArticle(),editDynamic(),deleteDynamicRepeat(!0),adminUI())}).catch(function(t){$(".menu_toggle").on("click",function(e){infoContainer(t,!1)}),deleteDynamicRepeat(!1)}):deleteDynamicRepeat(!1)}function adminUI(){$(".deleteDynamicRepeat").css("cursor","pointer"),$(".delete_msg").css("cursor","pointer")}function deleteDynamicRepeat(e){e?($(".deleteDynamicRepeat").css("cursor","cursor"),$(".dynamic").on("click",".deleteDynamicRepeat",function(){var e=this.getAttribute("_id"),t=this.getAttribute("_msgid"),n=$(this).closest("li");loadingUI("start"),fetch("/deleteDynamicMsg",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:e,msgId:t})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){loadingUI("end"),e&&e.success?(infoContainer("删除成功",!0),n.remove()):infoContainer("删除失败"+e&&e.errorMsg||e)})})):$(".deleteDynamicRepeat").css("cursor","not-allowed")}function loginState(){var e=document.cookie.split("; "),t=[];for(var n in e)t.push(e[n].split("="));var i=0,o=!0,a=!1,r=void 0;try{for(var s,l=t[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;if("user"===c[0]||window.sessionStorage&&sessionStorage.getItem("user"))return window.sessionStorage&&!sessionStorage.getItem("user")&&sessionStorage.setItem("user",c[1]),rememberLoginState(Base64.decode(sessionStorage.getItem("user")||c[1])),$(".all_user span").text("注销"),$(".user_name").html(Base64.decode(sessionStorage.getItem("user")||c[1])),getAvatar(Base64.decode(sessionStorage.getItem("user")||c[1])),repeatCon(Base64.decode(sessionStorage.getItem("user")||c[1])),uploadAvatar(Base64.decode(sessionStorage.getItem("user")||c[1])),$("#avatar").show(),$("#setAvatarTip").show(),messageOperation(Base64.decode(sessionStorage.getItem("user")||c[1])),void checkPerssion(Base64.decode(sessionStorage.getItem("user")||c[1]));i++}}catch(e){a=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw r}}i===t.length&&(loginWarning(),getAvatar("Ada"),messageOperation(void 0),repeatCon(void 0),$("#avatar").hide(),$(".all_user span").html("登陆"),$(".user_name").html("Ada"),checkPerssion(sessionStorage&&sessionStorage.getItem("user")&&Base64.decode(sessionStorage.getItem("user"))||void 0))}function adminToggle(){var e=window.innerWidth;$("#editIntroduce").click(function(){var e=$("#introduce_textarea").val();300<=e.length?infoContainer("不能超过300个字符",!1):""!==e.trim()?fetch("/updateIntroduce",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({introduce:e})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){e&&e.success?infoContainer("更新成功",1):infoContainer(e,!1)}).catch(function(e){return infoContainer(e&&e.errorMsg||e)}):infoContainer("不能为空",!1)}),$(".menu_toggle").off(".loginMove").on("click  ",function(){$(".admin").toggleClass("adminToggle"),$("header").toggleClass("headerToggle"),$("main").toggleClass("mainToggle"),$(".menu_toggle").toggleClass("btnToggle"),$(".admin").hasClass("adminToggle")?setTimeout(function(){$(".admin_menu li").eq(0).stop().animate({opacity:1,left:0},300,function(){$(".admin_menu li").eq(1).stop().animate({opacity:1,left:0},300,function(){$(".admin_menu li").eq(2).stop().animate({opacity:1,left:0},300,function(){$(".edit_ui").animate({opacity:1,right:0},100,function(){$(".select_line").show()}).find(".edit_ul").show().addClass("bounceInRight"),$(".admin_menu li").eq(3).stop().animate({opacity:1,left:0},300)})})})},300):($(".select_line").hide(),$(".edit_ui").animate({opacity:0,right:-e}).find(".edit_ul").hide().removeClass("bounceInRight"),$(".admin_menu li").stop().animate({left:-40,opacity:0},0))})}function rememberLoginState(e){$(".user_name").html(e),$("#login_anchor").html("register"),$(".loading").hide(),$(".screen").show(),loginOut(e)}function loginOut(e){var t=new Date(-1);$(".new_login").off(".exitLogin").on("click  ",function(){document.cookie="user="+e+"; path=/; expires="+t,sessionStorage.removeItem("user"),$(".login_register").show().css("z-index","999").find(".bar").animate({height:$(".login_register").height()/2},1e3,function(){location.reload()})})}function allUserList(){$(".all_user").on("click  ",function(){$("aside ul:nth-of-type(2)").toggleClass("all_users_show")})}function allArticle(){for(var e=$(".article_tittle"),t=e.length,n=0;n<t;n++){var i=$("<li>"+(n+1)+"."+$(e[n]).html()+"</li>");$(i).appendTo($(".all_article"))}}function adminEdit(){$(".admin_menu li a").on("click",function(){$(".edit_box").animate({opacity:0},500,function(){$(".edit_ul").removeClass("bounceOutRight")});$(this).parent().index();$(".select_line .dot").removeClass("bounce"),setTimeout(function(){$(".select_line .dot").addClass("bounce")},10)})}function infoContainer(e,t,n){t?($(".result-info").removeClass("false_dialog").addClass("true_dialog").show().find("p").text(e),$(".result-info i").css("color","#52c41a").html("&#xe6b3;")):($(".result-info").removeClass("true_dialog").addClass("false_dialog").show().find("p").text(e),$(".result-info i").css("color","#f5222d").html("&#xe67a;")),$(".result-info").hasClass("tada")&&(setTimeout(function(){$(".result-info").hide()},2500),n&&n())}function publishDynamic(){$("#publish_dw").on("click publish  ",function(){var e=$("#dw_title").val(),t=$("#short_article_textarea").val(),n=parseInt($("edit_li span").html()),i=new Date,o=i.getFullYear()+"-"+(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1)+"-"+(i.getDate()<10?"0"+i.getDate():i.getDate());if(checkBeforePublish({title:e,summary:t})){if(n<0)return void infoContainer("文字超出限制",!1);loadingUI("start"),fetch("/addDynamic",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({title:e,content:t,date:o,upvote:1})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){if(loadingUI("end"),e&&e.success){infoContainer("成功,你可以继续发布",!0),reRenderDynamic(e.data.reverse());$("#dw_title").val(""),$("#short_article_textarea").val("")}else infoContainer(e&&e.errorMsg||"网络繁忙"+e.status)})}else infoContainer("输入不完整",!1)})}function reRenderArticle(e){var t=template("article_tpl",{articles:e});$(".article_list").find("li").remove(),$(".article_list").append($(t));var n=template("article_operation_tpl",{articles:e});$(".o_all_article").find("li").remove(),$(".o_all_article").append($(n))}function reRenderDynamic(e){var t=template("dynamic_tpl",{dynamics:e});$(".dynamic").find("li").remove(),$(".dynamic").append($(t));var n=template("dynamic_operation_tpl",{dynamics:e});$(".all_short_article").find("li").remove(),$(".all_short_article").append($(n))}function checkBeforePublish(e){var t=!0;for(var n in e)if(""===e[n].trim()){t=!1;break}return t}function publishItem(){var t=$(".select_line").css("top"),n={url:null},i=$(".map_li");$(".admin_menu li a").on("click  ",function(){var e=$(this).parent().index();$(".select_line").animate({top:parseInt(t)+40*e},300),i.removeClass("pulse").hide().eq(e).addClass("pulse").show(),0===e?(n.url="saveDw",n.type="content"):2===e?(n.url="saveArticle",n.type="summary"):n.url=null}),$(".publish-edit").on("click  ",function(){var e=$(".editor-container").html();""!==$(".ql-editor").eq(0).text()?publishBtn(n,e):infoContainer("你还没有输入哦",!1)})}function cancleTextEdit(){$(".article_list").on("click  ",".ql-editor",function(){$(this).attr("contenteditable","false")})}function escapeData(e){return e.replace(/<input\stype="text"\sdata-formula="e=mc\^2"\sdata-link="quilljs\.com"\sdata-video="Embed\sURL">/g,"").replace(/<input\stype="text"\sdata-formula="e=mc\^2"\sdata-link="quilljs\.com"\sdata-video="Embed\sURL"\splaceholder="Embed\sURL">/g,"")}function setArticleType(){var e=$(".article-type input"),t="HTML";for(var n in e)e[n].checked&&(t=e[n].value);return t}function publishBtn(e,t){if(null!==e.url){var n=new Date;if("saveDw"===e.url)n.getFullYear(),n.getMonth(),n.getDate();else{if("saveArticle"!==e.url)return;var i=n.getMonth()+1,o=n.getDate(),a=(i<10?"0"+i:i)+"-"+(o<10?"0"+o:o),r=""+n.getFullYear(),s=(n.getHours()<10?"0"+n.getHours():n.getHours())+":"+(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())+":"+(n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds());loadingUI("start"),fetch("/"+e.url,{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({time:s,date:a,year:r,summary:escapeData(t),type:setArticleType()})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){loadingUI("end")(e&&e.success)?infoContainer("发布成功",!0,function(){return window.location.reload()}):infoContainer(e&&e.errorMsg||"网络繁忙"+e)})}}}function shortArticleLimited(){$(".edit_textarea").on("change",function(e){e=e||window.event;var t=180-$(this).val().length;$(this).next().find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()}),$(".edit_textarea").on("keydown",function(e){e=e||window.event;var t=180-$(this).val().length;$(this).next().find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()}),$(".edit_textarea").on("keyup",function(e){e=e||window.event;var t=180-$(this).val().length;$(this).next().find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()})}function articleLimited(){$("#article_textarea").on("change",function(e){e=e||window.event;var t=5e3-$(this).val().length;$(this).next().find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()}),$("#article_textarea").on("keydown",function(e){e=e||window.event;var t=5e3-$(this).val().length;$(this).next().find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()}),$("#article_textarea").on("keyup",function(e){e=e||window.event;var t=5e3-$(this).val().length;$(this).next().find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()})}function clearErrorInfo(){$(".edit_ul li textarea").focus(function(){$(".err_info").hide()}),$(".edit_ul li input[type=text]").focus(function(){$(".err_info").hide()}),$(".admin_menu li a").on("click  ",function(){$(".err_info").hide()}),$(".menu_toggle").on("click  ",function(){$(".err_info").hide()})}function hideNewError(){$(".new_content").focus(function(){$(".new_error_info").hide()}),$(".new_title").focus(function(){$(".new_error_info").hide()})}function deleteDynamic(){$(".all_short_article").on("click  ","a.delete_dynamic",function(){var n=$(this).closest("li"),e=this.getAttribute("_id");fetch("/deleteDynamic",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:e})}).then(function(e){return e.json()}).then(function(e){if(e&&e.success){n.remove(),infoContainer("删除成功",!0);var t=template("dynamic_tpl",{dynamics:e.data.reverse()});$(".dynamic").find("li").remove(),$(".dynamic").append($(t))}else infoContainer(e&&e.errorMsg||"网络繁忙",!1)})})}function deleteArticle(){$(".o_all_article").on("click  ","a.delete_article",function(){$(".delete_info").hide().removeClass("slideInDown");var t=$(this).closest("li"),e=t[0].attributes[0].value;loadingUI("start"),fetch("/deleteArticle",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:e})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){loadingUI("end"),e&&e.success?(t.remove(),infoContainer("删除成功",!0,function(){return window.location.reload()})):infoContainer(e&&e.errorMsg||"网络出错"+e.status)})})}function clearInfo(){$(".msg").on("click  ",function(){$(".insert_dialog").hide()})}function loadingUI(e){"start"===e?($(".loading-circle").addClass("runCircle"),$(".screen").addClass("blurBg"),$(".loadingUI").show()):"end"===e&&setTimeout(function(){$(".loading-circle").removeClass("runCircle"),$(".screen").removeClass("blurBg"),$(".loadingUI").hide()},1500)}function leaveMsg(){$(".leave_msg").on("click  ",function(){var e=escapeMessage($(".msg").val()),t=window.sessionStorage&&sessionStorage.getItem("user"),n=new Date,i=n.getMinutes(),o=n.getHours(),a=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()+"-----"+o+" : "+i;if(""===e)return infoContainer("输入不完整 ~",!1),$(".msg").removeClass("shake"),void setTimeout(function(){$(".msg").addClass("shake")},0);t?(loadingUI("start"),setTimeout(function(){$(".loadimg").css("transform","rotate(360deg)")},100),fetch("/leaveMessage",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({date:a,content:e,name:Base64.decode(t)})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){loadingUI("end"),e&&e.success?(randomUserAvatar(),reRenderMsg(e.data)):infoContainer(e&&e.errorMsg||"网络繁忙"+e),$(".load").hide()})):infoContainer("你还没有登陆",!1)})}function reRenderMsg(e){$(".loadimg").css("transform","rotate(0deg)"),$(".load").hide(),infoContainer("成功啦",!0),$(".msg").val(""),$(".msg_word_count span").text("280"),$(".message_list li").remove();var t=template("message-tpl",{messages:e instanceof Array&&e.reverse()});$(t).appendTo($(".message_list")),$(".temp_ul li:first-of-type").html(e.length+"评论"),$(".temp_ul li:last-of-type").html(e.length+"人参与"),allUserAvatar()}function wordLimited(){$(".msg").on("change",function(e){e=e||window.event;var t=280-$(this).val().length;$(".msg_word_count").find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()}),$(".msg").on("keydown",function(e){e=e||window.event;var t=280-$(this).val().length;$(".msg_word_count").find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()}),$(".msg").on("keyup",function(e){e=e||window.event;var t=280-$(this).val().length;$(".msg_word_count").find("span").html(t),t<=0&&8!=e.keyCode&&e.preventDefault()})}function slidePhoto(){$(".glitch_effect").glitch({zIndexDefault:0,effect1TimeMin:600,effect1TimeMax:900,effect2TimeMin:10,effect2TimeMax:115})}function upvoteDynamic(){$(".dynamic").on("click  ",".awesome_dynamic",function(){var t=this,n=this,e=n.getAttribute("_id");if(!n.isUpvote){var i=Number($(this).next().html())+1;fetch("/upvoteDynamic",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:e,upvote:i})}).then(function(e){return e.json()}).then(function(e){e&&e.success?($(n).next().html(i),n.isUpvote=!0,$(n).animate({fontSize:20,width:35},300,function(){$(t).animate({fontSize:16,width:25},300).css({color:"#f39e66",cursor:"not-allowed"})})):infoContainer("网络繁忙",n.isUpvote=!1)})}})}function bugReporter(){$(".bug-reporter").click(function(e){e.stopPropagation(),window.open("http://wpa.qq.com/msgrd?v=3&uin=3532371088&site=qq&menu=yes")})}function randomBg(){var e=Math.floor(6*Math.random())+1;$("body").css({background:'url("./resouce/bg/'+e+'.jpg") no-repeat',backgroundSize:"100% 100%"})}function changeTheme(){$(".change_theme").on("click  ",function(){$(this).toggleClass("themeapi"),$(".theme_containter").toggleClass("theme_show")}),$(".theme_containter ul li").on("click  ",function(){var e=$(this).index()+1;$("body").css({background:'url("./resouce/bg/'+e+'.jpg") no-repeat',backgroundSize:"100% 100%"})})}function hideAllClickWindow(){var i=document.getElementsByTagName("video");$(".search_result_container").on("click  ",function(e){(e=e||window.event).stopPropagation(),$(".context-menu").hide()}),$("body").on("click  ",function(e){for(var t in i)i[t].paused=!1;e=e||window.event;$(".dynamic-msg-container").hasClass("showMsg")&&$(".dynamic-msg-container").removeClass("showMsg"),$(".full_summary").text("").hide();var n=$(".article_list .article");n.removeClass("showArticle").find(".article_tittle").removeClass("article_title_toggle"),n.find(".article_summary").removeClass("toggleP"),n.find(".article_close").removeClass("showClose"),$(".right_article_list").show(500),$(".search_result_container").removeClass("show_search_container bounceInDown")})}function search(){$(".search_input").on("click  ",function(e){$(".get_search li").remove();e=e||window.event;$(".search_result_container").addClass("show_search_container bounceInDown"),e.stopPropagation(),$(".context-menu").hide()}),$(".search_input").on("keyup",function(e){var n,t=e||window.event,i=$(".search_input").val();if($(".full_summary").text(""),""!==i&&13===t.keyCode)return n=i,$(".get_search li").remove(),void fetch("/search",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({data:n})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){if(e&&e.success&&0!==e.result.length){var t=template("search_result_tpl",{searchs:e.result});$(t).appendTo($(".get_search"))}else infoContainer(e&&e.errorMsg||"网络繁忙"+e||'找不到关于"'+n+'"的信息',!1)})})}function fullSearch(){$(".search_result_container").on("mouseenter","li",function(){$(".article-type-text").removeClass("selectType");var e=$(this).find(".search_summary").offset().top?$(this).find(".search_summary").offset().top:86,t=$(this).find(".search_summary").height()||40,n=this.getAttribute("_id"),i=this.getAttribute("type");$(".full_summary").show(),$(".full_summary")[0].setAttribute("_id",n),$(".full_summary").html($(this).find(".search_summary").text()).stop().animate({top:e-t-40},300),"动态"===i?$(".full_summary").removeClass("artilce_type_summary").addClass("dynamic_type_summary"):$(".full_summary").removeClass("dynamic_type_summary").addClass("artilce_type_summary")})}function turnToSummary(){document.querySelector(".full_summary").onclick=function(e){(e=e||window.event).stopPropagation();var t=this.getAttribute("_id");"动态"!==this.getAttribute("type")&&triggerArticle(t)}}function triggerArticle(e){$(".triggerArticle").trigger("click");var t=document.getElementsByClassName("articles_list");for(var n in $(".articles_list").hide(),t)if(t[n].getAttribute("_id")===e)return void $(t[n]).show().trigger("click")}function introduce(e,t){var n=t.split(""),i=n.length,o=$(".introduce"),a="";if(o.focus(),""===o.val()){lifeStep();var r=setInterval(function(){a+=n[e],o.val(a),i<=++e&&(clearInterval(r),o.blur(),o[0].disabled=!0)},100)}}function lifeStep(){var e=$(".life .circle"),t=$(".life .line"),n=$(".life .step");e.eq(0).animate({opacity:1},1e3,function(){t.eq(0).animate({width:"100%"},1e3),n.eq(0).animate({top:"40%",opacity:1},1e3,function(){e.eq(1).animate({opacity:1},1e3,function(){t.eq(1).animate({width:"100%"},1e3),n.eq(1).animate({top:"40%",opacity:1},1e3,function(){e.eq(2).animate({opacity:1},1e3,function(){t.eq(2).animate({width:"100%"},1e3),n.eq(2).animate({top:"40%",opacity:1},1e3,function(){e.eq(3).animate({opacity:1},1e3,function(){t.eq(3).animate({width:"100%"},1e3),n.eq(3).animate({top:"40%",opacity:1},1e3)})})})})})})})}function wechat(){$(".wechat").on("click  ",function(){$(".wechat_img").toggleClass("wechat_show"),$(this).toggleClass("themeapi")})}function sina(){$(".sina_api").on("click  ",function(){$(".sina").toggleClass("sina_show"),$(this).toggleClass("themeapi")})}function dynamicMsg(){$(".dynamic").on("click  ",".dynamic-msg-icon",function(e){e.stopPropagation(),$(".context-menu").hide(),$(this).parent().next().toggleClass("showMsg")}),$(".dynamic").click(function(e){e.stopPropagation(),$(".context-menu").hide()}),$(".dynamic").on("click  ",".leave-dynamic-mg",function(e){$(this).closest(".dynamic-msg-container");e.stopPropagation(),$(".context-menu").hide();var t=new Date,n=this,i=t.getFullYear(),o=$(this).index(".leave-dynamic-mg"),a=t.getMonth()+1,r=t.getDate(),s=t.getHours(),l=t.getMinutes(),c=$(n).parent().parent().prev().find("span"),u=i+"-"+a+"-"+r+"--"+s+":"+l,d=$(this).prev().val(),f=$(this).closest("li")[0].getAttribute("_id"),h={context:d,date:u},g=sessionStorage&&sessionStorage.getItem("user");""!==d&&""!==d.trim()?100<d.length?infoContainer("字数不能超过100个字符",!1):g?fetch("/leave-dynamic-mg",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:f,msg:h,name:g})}).then(function(e){return e.json()}).then(function(e){if(e&&e.success){$(n).prev().val(""),c.text(parseInt(c.text())+1);var t=template("dynamic_tpl",{dynamics:e.data.reverse()});$(".dynamic").find("li").remove(),$(t).appendTo($(".dynamic")),$(".dynamic_item .dynamic-msg i").eq(o).trigger("click")}else infoContainer(e&&e.errorMsg||"网络繁忙",!1)}):infoContainer("登录才能评论哦",!1):infoContainer("评论不能为空",!1)})}function articleMsgBullet(){for(var t=$(".article-msg-board span"),e=function(e){setTimeout(function(){animationBullet(t.eq(e))},1e3*e)},n=0;n<t.length;n++)e(n)}function animationBullet(t){var n=Math.floor(2e4*Math.random()+12e3),i=t.parent().height(),e=window.innerWidth/4,o=Math.floor(Math.random()*e/2+100);t.css("left",o+"px"),function e(){t.animate({bottom:i},n,function(){t.animate({bottom:0},0,e)})}()}function randomTheme(){var e=Math.floor(5*Math.random()+1);$("body").css({background:'url("./../resouce/bg/'+e+'.jpg") no-repeat',backgroundSize:"cover"})}function textEdit(){new Quill("#editor-container",{modules:{formula:!0,syntax:!0,toolbar:"#toolbar-container"},placeholder:"Compose an epic...",theme:"snow"})}function articleDefault(){$("article_list li")}function getCustomer(){return new Promise(function(t,n){fetch("/get-customer",{headers:{"content-type":"application/json",accept:"application/json"}}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){e&&e.success?(document.getElementById("customer_number").innerText=""+e.data.number,t(e.data.number+1)):n(e&&e.errorMsg||"无法获取访问量"+e.status||"网络繁忙，无法获取访问量")})})}function customer(){getCustomer().then(function(e){fetch("/add-customer",{method:"POST",headers:{"content-type":"application/json",accept:"application.json"},body:JSON.stringify({number:e})})}).catch(function(e){return infoContainer(e,!1)})}function checkDevice(){window.innerWidth<750&&(alert("您正在使用移动端预览，移动端仅供预览，完整交互在pc端"),checkLoadingFinished($(".loading .loading_top").height()/2,290))}function callAllArticle(){return new Promise(function(t,n){$.get("/allArticle",function(e){e?t(e):n([])})})}function selectArticleType(){var n=$(".article-type-text");n.on("click",function(){n.removeClass("selectType flip"),$(this).addClass("selectType").addClass("flip");var e=$(this).text(),t=document.getElementsByClassName("articles");reducerArticle(e,Array.from(t))})}function reducerArticle(e,t){if("全部"!==e){$(t).hide().removeClass("bounceInUp");var n=!0,i=!1,o=void 0;try{for(var a,r=t[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;s.getAttribute("type")===e?$(s).addClass("bounceInUp").show():$(s).hide()}}catch(e){i=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}}else $(t).hide().show().addClass("bounceInUp")}function contextMenu(){var i=$(".context-menu");randomBgColor(),window.oncontextmenu=function(e){e.preventDefault();var t=e.clientX,n=e.clientY;i.css({left:t,top:n}),i.hide().removeClass("jello"),setTimeout(function(){i.show().addClass("jello")},20)},$(".context-menu ul li").on("click",function(e){e.stopPropagation()}),window.onclick=function(){i.hide()}}function randomUserAvatar(){var e=["#abd0bc","#62cf8e","#f46c3c","#b2b2b2","#ddc49c","#62b78d","#d1f9f1","#c4c4c4","#b89168","#ff766e","#1e89bd","#d34694","#c5d08d"],t=e.length,n=document.getElementsByClassName("user_avatar"),i=!0,o=!1,a=void 0;try{for(var r,s=n[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){r.value.style.background=e[Math.floor(Math.random()*t)]}}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}}function randomBgColor(){var e=$(".loading_top").height(),i=["#abd0bc","#62cf8e","#f46c3c","#b2b2b2","#ddc49c","#62b78d","#d1f9f1","#c4c4c4","#b89168","#ff766e","#1e89bd","#d34694","#c5d08d","#4ae488"],o=i.length;$(".random-bg").on("click",function(){var e=Math.floor(Math.random()*o),t=Math.floor(Math.random()*o),n=Math.floor(Math.random()*o);$("body").css("background","linear-gradient(to bottom, "+i[e]+", "+i[t]+", "+i[n]+")")}),$(".menu-reload").click(function(){window.location.reload()}),$(".close-blog").click(function(){$(".tempexit").hide(),$(".loading").show(),$(".loading_top").animate({height:0},0).animate({height:e},700),$(".loading_down").animate({height:0},0).animate({height:e},700,function(){setTimeout(function(){window.location.href="https://www.baidu.com/"},500)})})}function fullScreen(){var e=document.documentElement;window.ActiveXObject?new ActiveXObject("WScript.Shell").SendKeys("{F11}"):e.requestFullScreen?e.requestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen&&e.mozRequestFullScreen()}function editEffect(){$(".edit_textarea").focus(function(e){$(".effect_text").css("width","40px")}),$(".edit_textarea").blur(function(e){$(".effect_text").css("width","0")})}function toggleRepeatList(){$(".message_box").on("click",".togger_repeat_list",function(){$(this).next().toggle(300),/展开/.test($(this).text())?$(this).text("收起"):$(this).text("展开")})}function messageBoxHover(){$(".message_box").hover(function(){$(".message_box").stop().animate({top:"30px",height:"100%"}),$(".message_board_input").hide(),$(".temp_ul").hide()},function(){$(".message_box").stop().animate({top:"255px",height:"65%"},function(e){$(".message_board_input").show(),$(".temp_ul").show()})})}function allUserAvatar(){var h=$(".user_name_msg"),e=[],t=!0,n=!1,i=void 0;try{for(var o,a=h[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value;e.push(r.innerText)}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}var s=[].concat(_toConsumableArray(new Set(e)));fetch("/all_user_avatar",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({name:s})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){if(e&&e.success){var t=!0,n=!1,i=void 0;try{for(var o,a=h[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value,s=!0,l=!1,c=void 0;try{for(var u,d=e.data[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var f=u.value;$(r).text()===f.name&&($(r).parent().prev().find("img")[0].src=f.avatar)}}catch(e){l=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw c}}}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}else infoContainer(e&&e.errorMsg||"网络出错"+e.status,!1)})}function openSouceContainer(){"block"!==$(".sourceContainer").css("display")&&($(".initDisplay").hide(),$(".sourceContainer").show(500),randomAbountMe())}function entryMoreOperation(){var e=new Mobile({target:document.getElementsByClassName("left_container")[0],menu:[{name:"关于主页",callback:entryAboutMe},{name:"资源管理",callback:openSouceContainer}],bg:"./resouce/images/menu.jpg"}),t=$(".more_operation_container");$(".more_operation_entry").on("click",function(){"更多"===this.innerText?(e.start(),this.innerText="X",$(".body_overlay").animate({opacity:1},function(e){return $(".body_overlay").css("z-index","5")}),t.css("width","1%").stop().animate({height:"100%"},300,function(e){return t.animate({width:"100%"})})):(this.innerText="更多",$(".body_overlay").animate({opacity:0},function(e){return $(".body_overlay").css("z-index","0")}),t.stop().animate({width:"1%"},300,function(e){t.animate({height:"0%"},function(e){return t.css("width","0")})}),$(".another_entry").hasClass("another_toggel")&&$(".another_entry").trigger("click"),$(".about_me_entry").hasClass("entry_about_me_toggle")&&$(".about_me_entry").trigger("click"))})}function randomAbountMe(){var e=$(".about_me_container .box");e.hide();var t=!0,n=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var r=o.value,s=300*(Math.random()+1),l=3*Math.random(),c=parseInt(s)%2==0?-1:1,u=300*(Math.random()+1);$(r).css({transition:"all "+l+"s",opacity:"0",transform:"translateX("+c*s+"px) translateY("+c*u+"px)"})}}catch(e){n=!0,i=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw i}}}function startAnotherFace(e){var t=$(".right_container .box_");if(e){$(".right_container").show();var n=!0,i=!1,o=void 0;try{for(var a,r=t[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value,l=7*Math.random();$(s).css("animation-duration",l+"s")}}catch(e){i=!0,o=e}finally{try{!n&&r.return&&r.return()}finally{if(i)throw o}}t.addClass("bounceIn").show()}else t.removeClass("bounceIn").hide(),$(".right_container").hide()}function initMore(){new Mobile({target:document.getElementsByClassName("left_container")[0],menu:[{name:"关于主页"},{name:"menu-test"}],bg:"./resouce/images/menu.jpg"}).start()}function entryAboutMe(){$(".initDisplay").hide(),$(".about_me_container").show(),$(".about_me_container .box").show().css({transform:"translate(0) scale(1.009)",opacity:"1"})}function getBodyBg(){return $("body").css("background-image")}function initOverLay(){for(var e=$(".more_operation_container"),t=0;t<200;t++){var n=document.createElement("div");n.className="temp_overLay",$(n).appendTo(e)}}function concoleEffect(){var c=$(".consoel_container .temp_six"),u={l:$(".about_me_entry").css("left"),t:$(".about_me_entry").css("top")};c.on("click",function(){var e=$(this).css("left"),t=$(this).css("top"),n=$(this).css("margin-left"),i=!0,o=!1,a=void 0;try{for(var r,s=c[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;"200px"===$(l).css("left")&&"136px"===$(l).css("top")&&"-50px"===$(l).css("margin-left")&&$(l).css({left:e,top:t,marginLeft:n})}}catch(e){o=!0,a=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw a}}$(this).css({left:"50%",top:u.t,marginLeft:"-50px"}),c.addClass("concole_toggle"),$(this).removeClass("concole_toggle")})}function mobileEntry(){$(".entry_mibile").click(function(e){return $(".mobile_entry").toggleClass("showSlideBar")})}function loginApi(){$(".login-i").click(function(){"block"===$(".registerbtn").css("display")?$(".registerbtn").trigger("click"):$(".current-api").trigger("click")})}function share(){$(".shareToSina").click(function(e){!function(e,t,n){var i="http://v.t.sina.com.cn/share/share.php?",o=t.location.href,a=["url=",n(o),"&title=",n("个人主页"),"&appkey=2924220432","&pic=",n("http://wx4.sinaimg.cn/mw690/a99a6e98ly1fox8tzjwvaj211l0hmq39.jpg || http://wx4.sinaimg.cn/mw690/a99a6e98ly1fox8u9irlkj211x0hndnw.jpg || http://wx4.sinaimg.cn/mw690/a99a6e98ly1fox8u5cwpsj211y0hltn0.jpg || http://wx4.sinaimg.cn/mw690/a99a6e98ly1fox8udqz9yj211x0hntde.jpg")].join("");function r(){window.open([i,a].join(""),"mb",["toolbar=0,status=0,resizable=1,width=620,height=450,left=",(e.width-620)/2,",top=",(e.height-450)/2].join(""))||(o.href=[i,a].join(""))}/Firefox/.test(navigator.userAgent)?setTimeout(r,0):r()}(screen,document,encodeURIComponent)}),$("#zone").click(function(){var e={url:"http://adaxh.applinzi.com",showcount:"1",summary:"个人主页，快来看看吧！",title:"个人主页",pics:"https://camo.githubusercontent.com/55b9bef92d318357c3688e135d9723519f7085f1/687474703a2f2f7778322e73696e61696d672e636e2f6d773639302f61393961366539386c7931666f783962396c3434696a32307367306c633435372e6a7067",style:"203",width:98,height:22},t=[];for(var n in e)t.push(n+"="+encodeURIComponent(e[n]||""));window.open("http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+t.join("&"))})}function innerRepeat(){$(".message_box").on("click",".innerRepeatAPI",function(){var n=this.getAttribute("_parent_id"),i=this.getAttribute("_to_repeat"),o=window.sessionStorage&&sessionStorage.getItem("user")||void 0;o?sendRepeat(function(e,t){fetch("/repeatMsg",{method:"post",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:n,msg:{name:Base64.decode(o),toRepeat:i,info:t,date:e}})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){loadingUI("end"),e&&e.success?(reRenderMsg(e.data),$(".repeat_word").val(""),$(".cancel_repeat").trigger("click")):infoContainer(e&&e.errorMsg||"网络繁忙"+e)})}):infoContainer("你还没有登录哦",!1)}),$(".message_box").on("click",".innerDeleteMsg",function(){var t=this,e=this.getAttribute("_parent_id"),n=this.getAttribute("_id"),i=sessionStorage.getItem("user")||void 0;sessionStorage.getItem("user")?(loadingUI("start"),fetch("/deleteInnerRepeat",{method:"post",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:n,_parent_id:e,name:Base64.decode(i)})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e.status}).then(function(e){loadingUI("end"),e&&e.success?(infoContainer("删除成功",!0),$(t).closest("li").remove()):infoContainer(e&&e.errorMsg||"网络繁忙"+e)})):infoContainer("你还没有登录",!1)})}function closeTip(){$(".closeTip").click(function(){$(".avatarTip").hide()})}function updateArticle(){$(".o_all_article").on("click",".update_article_icon",function(){var o=this.attributes[0].value;loadingUI("start"),fetch("/queryArticleById",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:o})}).then(function(e){return 200<=e.status&&e.status<300?e.json():e}).then(function(e){if(loadingUI("end"),e&&e.success){var t=e.data,n=t.summary,i=t.type;editArticle(n,o,i)}else infoContainer(e&&e.errorMsg||"网络出错 "+e.status)})})}function editArticle(t,n,e){$(".admin_menu li:nth-of-type(3) a").trigger("click"),$(".editor-container").html(t);var i=$("#artilce-type-label span"),o=!0,a=!1,r=void 0;try{for(var s,l=i[Symbol.iterator]();!(o=(s=l.next()).done);o=!0){var c=s.value;if(c.innerText===e){$(c).prev()[0].checked=!0;break}}}catch(e){a=!0,r=e}finally{try{!o&&l.return&&l.return()}finally{if(a)throw r}}$(".publish-edit").off("click").on("click",function(){var e=$(".editor-container").html();e!==t?updateArticleById(n,e):infoContainer("内容未更改",!1)})}function updateArticleById(e,t){var n=setArticleType();loadingUI("start"),fetch("/updateArticleById",{method:"POST",headers:{"content-type":"application/json",accept:"application/json"},body:JSON.stringify({_id:e,summary:t,type:n})}).then(function(e){return e.json()}).then(function(e){loadingUI("end"),e&&e.success?infoContainer("更新成功",!0,function(){return window.location.reload()}):infoContainer(e&&e.errorMsg||"网络繁忙")})}function reloadArticle(){$(".article_list").empty(),$.get("allArticle",function(e){for(var t in e){var n=' <li class="article" _id='+e[t]._id+'>\n                      <i class="article_close linkfont">&#xe629;</i>\n                      <span class="article_date">'+e[t].date+'<p class="year">'+e[t].year+'</p></span>\n                      <div class="article_summary">'+e[t].summary+"</div>\n                  </li>";$(".article_list").prepend($(n)),randomArticleBg()}})}function getDynamic(e){return new Promise(function(t,n){$.post("/dynamicQueryById",{_id:e},function(e){e?t(e):n([])})})}function dynamicResult(e){getDynamic(e).then(function(e){setText(e)})}function setText(n){$("#dw_title").val(n.title),$(".edit_textarea ").val(n.content),$("span.count").html("180"-n.content.length),$("#publish_dw").off("click").on("click",function(){var e=$(".edit_textarea ").val(),t=$("#dw_title").val();e!==n.content||t!==n.title?updateDynamicById(n._id,e,t):infoContainer("内容为更改!!!",!1)})}function updateDynamicById(e,t,n){$.post("/updateDynamic",{_id:e,content:t,title:n},function(e){e?infoContainer("更新成功",!0,function(){window.location.reload()}):infoContainer("更新失败，请稍后重试",!1)})}function editDynamic(){$(".all_short_article").on("click","a.edit_item_dynamic",function(){var e=this.getAttribute("_id");$(".admin_menu li:nth-of-type(1) a").trigger("click"),dynamicResult(e)})}function mapToArticleList(){var e=$(".article_list li.article").slice();if(1!==e.length){for(var t=[],n={},i=0,o=e.length;i<o;i++){var a=e.eq(i).find("h2").text();n={date:e.eq(i).find("span.article_date").text(),title:a,_id:e[i].attributes._id.value},t.push(n)}mapToOperation(t)}}function mapToOperation(e){var t=template("article_operation_tpl",{data:e});$(".o_all_article").append($(t))}function randomArticleBg(){for(var e=[{bgc:"#d9edf7",color:"#31708f"},{bgc:"#f2dede",color:"#a94442"},{bgc:"#fff3cc",color:"#ffc100"},{bgc:"#f6edfb",color:"#cd97eb"},{bgc:"#fcf8e3",color:"#8a6d3b"},{bgc:"rgb(225, 249, 220)",color:"#31708f"},{bgc:"rgb(212, 253, 204)",color:"#31708f"},{bgc:"#fcfcfc",color:"#31708f"}],t=$(".article_list .article"),n=0,i=t.length;n<i;n++){var o=Math.floor(Math.random()*e.length);t.eq(n).css("background",e[o].bgc)}}function test(){$(".leave_message").on("click  ",function(){$("header .nav li a").eq(2).trigger("click")})}function exitGallery(){$(".exit_gallery").on("click  ",function(){$(".canvas_box").css({zIndex:-100,transform:"scale(0)"})})}function galleryApi(){$(".gallery_api").on("click  ",function(){$(".canvas_box").css({zIndex:1e3,transform:"scale(1)"})})}window.onload=function(){articleDefault()},$(function(){innerRepeat(),share(),loginApi(),hashRouter(),mobileEntry(),randomBg(),randomAbountMe(),entryMoreOperation(),allUserAvatar(),toggleRepeatList(),randomUserAvatar(),editEffect(),turnToSummary(),bugReporter(),contextMenu(),selectArticleType(),checkDevice(),customer(),cancleTextEdit(),dynamicMsg(),clearInfo(),sina(),wechat(),fullSearch(),hideAllClickWindow(),changeTheme(),search(),loginState(),showArticle(),loading(),init(),selectNav(),face1LeftbaraShake(),register(),loginFn(),exitLoginRegCancel(),allUserList(),allArticle(),messageCount($(".message_list li").length),shortArticleLimited(),articleLimited(),clearErrorInfo(),leaveMsg(),wordLimited(),galleryApi(),exitGallery(),slidePhoto(),upvoteDynamic(),hideNewError(),test(),randomArticleBg(),mapToArticleList(),closeTip()}),function(){"use strict";var a,r,s,l,c,u,d,f,h,g,i,t,o;(u=[],d=[],f=0,h=[1,2],g=function(e,t){if(this.parent=e,this.ctx=a,this.color=t.fill||!1,this.points=[],!t.img){for(var n=0;n<4;n++)this.points[n]=new ge1doot.transform3D.Point(e.pc.x+t.x[n]*e.normalZ+t.z[n]*e.normalX,e.pc.y+t.y[n],e.pc.z+t.x[n]*e.normalX+-t.z[n]*e.normalZ);this.points[3].next=!1}},i=function(e,t,n){this.img=new ge1doot.transform3D.Image(this,e+t.img,1,{isLoaded:function(e){e.parent.isLoaded=!0,e.parent.loaded(e)}}),this.visible=!1,this.normalX=t.nx,this.normalZ=t.nz,this.pc=new ge1doot.transform3D.Point(t.x,t.y,t.z),this.tx=t.x+t.nx*Math.sqrt(l.focalLength)*20,this.tz=t.z-t.nz*Math.sqrt(l.focalLength)*20,this.poly=[];for(var i,o=-1;i=n[++o];)d[o]=!0===i.img?1:2,this.poly.push(new g(this,i))},t=function(e){g.prototype.drawPoly=ge1doot.transform3D.drawPoly,s=new ge1doot.Screen({container:"canvas"}),a=s.ctx,s.resize(),r=new ge1doot.Pointer({tap:function(){if(l.over)if(l.over===l.target.elem)l.target.x=0,l.target.z=0,l.target.elem=!1;else{l.target.elem=l.over,l.target.x=l.over.tx,l.target.z=l.over.tz;for(var e,t=0;e=u[t++];){var n=l.target.x-e.pc.x,i=l.target.z-e.pc.z,o=1500<Math.sqrt(n*n+i*i)?h[0]:h[1];e.img.setLevel(o)}}}}),(l=new ge1doot.transform3D.Camera({focalLength:10*Math.sqrt(s.width),easeTranslation:.025,easeRotation:.06,disableRz:!0},{move:function(){this.over=!1,r.isDraging?(this.target.elem=!1,this.target.ry=.01*-r.Xi,this.target.rx=(r.Y-.5*s.height)/(.5*s.height)):this.target.elem&&(this.target.ry=Math.atan2(this.target.elem.pc.x-this.x,this.target.elem.pc.z-this.z)),this.target.rx*=.9}})).z=-1e4;for(var t,n=l.py=0;t=e.imgdata[n++];)u.push(new i(e.options.imagesPath,t,e.structure));setInterval(function(){h=50<f?[2,3]:[1,2],f=0},1e3),o()},o=function e(){a.clearRect(0,0,s.width,s.height),l.move();for(var t,n=-1;t=d[++n];){c=!1;for(var i,o=0;i=u[o++];)1===t&&i.draw()||i.visible&&i.poly[n].draw()}l.over&&!r.isDraging?s.setCursor("pointer"):s.setCursor("move"),f++,requestAnimFrame(e)},g.prototype.draw=function(){var e=this.color;if(e.light||!c){var t=e.light?this.parent.light:1;c="rgba("+Math.round(e.r*t)+","+Math.round(e.g*t)+","+Math.round(e.b*t)+","+(e.a||1)+")",a.fillStyle=c}if(!e.light||this.parent.light<1){for(var n=0;this.points[n++].projection(););this.drawPoly(),a.fill()}},i.prototype.loaded=function(e){for(var t=[-1,1,1,-1,1,1,-1,-1],n=.5*e.texture.width,i=.5*e.texture.height,o=0;o<4;o++)e.points[o]=new ge1doot.transform3D.Point(this.pc.x+n*this.normalZ*t[o],this.pc.y+i*t[o+4],this.pc.z+n*this.normalX*t[o])},i.prototype.draw=function(){return this.pc.projection(),this.pc.Z>-(l.focalLength>>1)&&this.img.transform3D(!0)?(this.light=.5+.6*Math.abs(this.normalZ*l.cosY-this.normalX*l.sinY),this.visible=!0,this.img.draw(),(r.hasMoved||r.isDown)&&this.img.isPointerInside(r.X,r.Y)&&(l.over=this)):this.visible=!1,!0},{load:function(e){window.addEventListener("load",function(){ge1doot.loadJS("./js/imageTransform3D.js",t,e)},!1)}}).load({imgdata:[{img:"./../resouce/gallery/1.jpg",x:-1e3,y:0,z:1500,nx:0,nz:1},{img:"./../resouce/gallery/2.jpg",x:0,y:0,z:1500,nx:0,nz:1},{img:"./../resouce/gallery/3.jpg",x:1e3,y:0,z:1500,nx:0,nz:1},{img:"./../resouce/gallery/4.jpg",x:1500,y:0,z:1e3,nx:-1,nz:0},{img:"./../resouce/gallery/5.jpg",x:1500,y:0,z:0,nx:-1,nz:0},{img:"./../resouce/gallery/6.jpg",x:1500,y:0,z:-1e3,nx:-1,nz:0},{img:"./../resouce/gallery/7.jpg",x:1e3,y:0,z:-1500,nx:0,nz:-1},{img:"./../resouce/gallery/8.jpg",x:0,y:0,z:-1500,nx:0,nz:-1},{img:"./../resouce/gallery/9.jpg",x:-1e3,y:0,z:-1500,nx:0,nz:-1},{img:"./../resouce/gallery/10.jpg",x:-1500,y:0,z:-1e3,nx:1,nz:0},{img:"./../resouce/gallery/11.jpg",x:-1500,y:0,z:0,nx:1,nz:0},{img:"./../resouce/gallery/12.jpg",x:-1500,y:0,z:1e3,nx:1,nz:0}],structure:[{fill:{r:255,g:255,b:255,light:1},x:[-1001,-490,-490,-1001],z:[-500,-500,-500,-500],y:[500,500,-500,-500]},{fill:{r:255,g:255,b:255,light:1},x:[-501,2,2,-500],z:[-500,-500,-500,-500],y:[500,500,-500,-500]},{fill:{r:255,g:255,b:255,light:1},x:[0,502,502,0],z:[-500,-500,-500,-500],y:[500,500,-500,-500]},{fill:{r:255,g:255,b:255,light:1},x:[490,1002,1002,490],z:[-500,-500,-500,-500],y:[500,500,-500,-500]},{fill:{r:0,g:0,b:0,a:.2},x:[-420,420,420,-420],z:[-500,-500,-500,-500],y:[150,150,-320,-320]},{fill:{r:0,g:0,b:0,a:.2},x:[-20,20,20,-20],z:[-500,-500,-500,-500],y:[250,250,150,150]},{fill:{r:0,g:0,b:0,a:.2},x:[-20,20,20,-20],z:[-500,-500,-500,-500],y:[-320,-320,-500,-500]},{fill:{r:0,g:0,b:0,a:.2},x:[-20,20,10,-10],z:[-500,-500,-100,-100],y:[-500,-500,-500,-500]},{fill:{r:32,g:32,b:32},x:[-50,50,50,-50],z:[-150,-150,-50,-50],y:[-500,-500,-500,-500]},{fill:{r:16,g:16,b:16},x:[-10,10,10,-10],z:[-100,-100,-100,-100],y:[300,300,-500,-500]},{fill:{r:255,g:255,b:255},x:[-320,-320,-320,-320],z:[0,-20,-20,0],y:[-190,-190,190,190]},{fill:{r:255,g:255,b:255},x:[320,320,320,320],z:[0,-20,-20,0],y:[-190,-190,190,190]},{img:!0},{fill:{r:255,g:128,b:0},x:[-50,50,50,-50],z:[450,450,550,550],y:[500,500,500,500]},{fill:{r:255,g:128,b:0},x:[-50,50,50,-50],z:[450,450,550,550],y:[-500,-500,-500,-500]}],options:{imagesPath:""}})}();