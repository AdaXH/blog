const{reMapError}=require("../common/util"),{isJSON}=require("../common/util");module.exports=async(e,r)=>{try{var{body:o}=e,a="string"==typeof o;if(a&&!isJSON(o))return;var s=a?JSON.parse(o):o;if(!s||!0===s)return;var{errorMsg:i}=s||{};i&&(e.body={...s,errorMsg:reMapError(i),errorStack:i})}catch(r){e.body={success:!1,errorMsg:"服务调用异常",errorType:"middleware",error:r}}finally{await r()}};